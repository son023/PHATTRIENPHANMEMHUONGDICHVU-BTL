# üìä Module ƒê·∫∑t v√© xem phim - Ph√¢n t√≠ch v√† Thi·∫øt k·∫ø

## 1. üéØV·∫•n ƒë·ªÅ c·∫ßn gi·∫£i quy·∫øt

### M√¥ t·∫£ chung
H·ªá th·ªëng ƒë·∫∑t v√© xem phim cho ph√©p kh√°ch h√†ng ch·ªçn phim, su·∫•t chi·∫øu, gh·∫ø ng·ªìi
v√† ti·∫øn h√†nh ƒë·∫∑t v√© tr·ª±c tuy·∫øn. Sau khi kh√°ch h√†ng ch·ªçn phim, h·ªá th·ªëng s·∫Ω ki·ªÉm tra t√¨nh
tr·∫°ng ch·ªó ng·ªìi, x√°c minh th√¥ng tin v√©, v√† x·ª≠ l√Ω thanh to√°n. N·∫øu ƒë·∫∑t v√© th√†nh c√¥ng, h·ªá
th·ªëng s·∫Ω g·ª≠i th√¥ng b√°o x√°c nh·∫≠n v√© ƒë√£ ƒë·∫∑t ƒë·∫øn email c·ªßa kh√°ch h√†ng.

### M√¥ t·∫£ chi ti·∫øt
1. B·∫Øt ƒë·∫ßu quy tr√¨nh ƒë·∫∑t v√©: Kh√°ch h√†ng truy c·∫≠p h·ªá th·ªëng v√† b·∫Øt ƒë·∫ßu quy tr√¨nh ƒë·∫∑t
v√© xem phim.
2. Ch·ªçn phim v√† su·∫•t chi·∫øu: Kh√°ch h√†ng ch·ªçn phim mu·ªën xem, c√πng v·ªõi su·∫•t
   chi·∫øu c·ª• th·ªÉ.
3. Ch·ªçn gh·∫ø ng·ªìi: Kh√°ch h√†ng ch·ªçn gh·∫ø ng·ªìi t·ª´ danh s√°ch c√°c gh·∫ø trong l·ªãch chi·∫øu t∆∞∆°ng ·ª©ng.
4. X√°c minh gh·∫ø ng·ªìi c√≤n tr·ªëng: H·ªá th·ªëng ki·ªÉm tra t√¨nh tr·∫°ng gh·∫ø ng·ªìi ƒë√£ ƒë∆∞·ª£c
   ch·ªçn xem c√≤n tr·ªëng hay ƒë√£ c√≥ ng∆∞·ªùi ƒë·∫∑t.
5. N·∫øu kh√¥ng c√≤n gh·∫ø ng·ªìi, k·∫øt th√∫c quy tr√¨nh: N·∫øu gh·∫ø ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t b·ªüi ng∆∞·ªùi
   kh√°c, h·ªá th·ªëng th√¥ng b√°o v√† d·ª´ng quy tr√¨nh.
6. Nh·∫≠p th√¥ng tin kh√°ch h√†ng: Kh√°ch h√†ng cung c·∫•p c√°c th√¥ng tin c√° nh√¢n nh∆∞ h·ªç
   t√™n, s·ªë ƒëi·ªán tho·∫°i v√† email.
7. X√°c minh th√¥ng tin v√©: H·ªá th·ªëng x√°c minh th√¥ng tin v√© xem phim v√† c√°c chi ti·∫øt
   li√™n quan.
8. Th·ª±c hi·ªán thanh to√°n: Kh√°ch h√†ng ti·∫øn h√†nh thanh to√°n tr·ª±c tuy·∫øn
   th√¥ng qua c√°c c·ªïng thanh to√°n.
9. N·∫øu thanh to√°n th√†nh c√¥ng, g·ª≠i th√¥ng b√°o x√°c nh·∫≠n: N·∫øu giao d·ªãch th√†nh c√¥ng,
   h·ªá th·ªëng g·ª≠i th√¥ng b√°o x√°c nh·∫≠n v√© ƒë√£ ƒë·∫∑t ƒë·∫øn email c·ªßa kh√°ch h√†ng.
10. C·∫≠p nh·∫≠t t√¨nh tr·∫°ng gh·∫ø ng·ªìi: H·ªá th·ªëng c·∫≠p nh·∫≠t t√¨nh tr·∫°ng gh·∫ø ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t v√†o
    c∆° s·ªü d·ªØ li·ªáu.
11. L∆∞u th√¥ng tin v√© v√† kh√°ch h√†ng v√†o c∆° s·ªü d·ªØ li·ªáu: H·ªá th·ªëng l∆∞u th√¥ng tin v√© ƒë√£
    ƒë·∫∑t v√† th√¥ng tin kh√°ch h√†ng v√†o c∆° s·ªü d·ªØ li·ªáu ƒë·ªÉ qu·∫£n l√Ω.

<!-- <p align="center">
  <img src="./assets/flow.png" alt="Lu·ªìng x·ª≠ l√≠" />
  <br/>
  <sub>Lu·ªìng x·ª≠ l√≠ c·ªßa module</sub>
</p> -->

---

## 2. üß© Ph√¢n t√≠ch, thi·∫øt k·∫ø c√°c module d·ªãch v·ª•

### B∆∞·ªõc 1: Ph√¢n t√°ch quy tr√¨nh nghi·ªáp v·ª•

| B∆∞·ªõc | H√†nh ƒë·ªông                                            |
|------|------------------------------------------------------|
| 1    | B·∫Øt ƒë·∫ßu quy tr√¨nh                                    |
| 2    | T·∫£i th√¥ng tin phim                                   |
| 3    | Kh√°ch h√†ng ch·ªçn phim                                 |
| 4    | T·∫£i th√¥ng tin l·ªãch chi·∫øu ·ª©ng v·ªõi phim ƒë∆∞·ª£c ch·ªçn      |
| 5    | Kh√°ch h√†ng ch·ªçn l·ªãch chi·∫øu                           |
| 6    | T·∫£i th√¥ng tin gh·∫ø t∆∞∆°ng ·ª©ng v·ªõi l·ªãch chi·∫øu ƒë∆∞·ª£c ch·ªçn |
| 7    | Kh√°ch h√†ng ch·ªçn gh·∫ø                                  |
| 8    | X√°c minh gh·∫ø c√≤n tr·ªëng                               |
| 9    | N·∫øu t·ªìn t·∫°i gh·∫ø kh√¥ng tr·ªëng th√¨ d·ª´ng quy tr√¨nh       |
| 10   | Kh√°ch h√†ng nh·∫≠p th√¥ng tin c√° nh√¢n                    |
| 11   | X√°c minh th√¥ng tin v√©                                |
| 12   | Kh√°ch h√†ng ch·ªçn thanh to√°n                           |
| 13   | C·∫≠p nh·∫≠t t√¨nh tr·∫°ng gh·∫ø sang ƒë√£ gi·ªØ                  |
| 14   | T·∫°o m√£ QR thanh to√°n                                 |
| 15   | Kh√°ch h√†ng th·ª±c hi·ªán thanh to√°n                      |
| 16   | Theo d√µi ti·∫øn tr√¨nh thanh to√°n                       |
| 17   | N·∫øu thanh to√°n th·∫•t b·∫°i th√¨ d·ª´ng quy tr√¨nh           |
| 18   | G·ª≠i email th√¥ng b√°o ƒë·∫∑t v√© th√†nh c√¥ng                |
| 19   | C·∫≠p nh·∫≠t t√¨nh tr·∫°ng gh·∫ø sang ƒë√£ ƒë·∫∑t                  |
| 20   | L∆∞u th√¥ng tin v√© v√† kh√°ch h√†ng                       |


### B∆∞·ªõc 2: Lo·∫°i b·ªè c√°c h√†nh ƒë·ªông kh√¥ng ph√π h·ª£p

| B∆∞·ªõc | H√†nh ƒë·ªông                                            |
|------|------------------------------------------------------|
| 1    | B·∫Øt ƒë·∫ßu quy tr√¨nh                                    |
| 2    | T·∫£i th√¥ng tin phim                                   |
| 3    | ~~Kh√°ch h√†ng ch·ªçn phim~~                             |
| 4    | T·∫£i th√¥ng tin l·ªãch chi·∫øu ·ª©ng v·ªõi phim ƒë∆∞·ª£c ch·ªçn      |
| 5    | ~~Kh√°ch h√†ng ch·ªçn l·ªãch chi·∫øu~~                       |
| 6    | T·∫£i th√¥ng tin gh·∫ø t∆∞∆°ng ·ª©ng v·ªõi l·ªãch chi·∫øu ƒë∆∞·ª£c ch·ªçn |
| 7    | ~~Kh√°ch h√†ng ch·ªçn gh·∫ø~~                              |
| 8    | X√°c minh gh·∫ø c√≤n tr·ªëng                               |
| 9    | N·∫øu t·ªìn t·∫°i gh·∫ø kh√¥ng tr·ªëng th√¨ d·ª´ng quy tr√¨nh       |
| 10   | ~~Kh√°ch h√†ng nh·∫≠p th√¥ng tin c√° nh√¢n~~                |
| 11   | X√°c minh th√¥ng tin v√©                                |
| 12   | ~~Kh√°ch h√†ng ch·ªçn thanh to√°n~~                       |
| 13   | C·∫≠p nh·∫≠t t√¨nh tr·∫°ng gh·∫ø sang ƒë√£ gi·ªØ                  |
| 14   | T·∫°o m√£ QR thanh to√°n                                 |
| 15   | ~~Kh√°ch h√†ng th·ª±c hi·ªán thanh to√°n~~                  |
| 16   | Theo d√µi ti·∫øn tr√¨nh thanh to√°n                       |
| 17   | N·∫øu thanh to√°n th·∫•t b·∫°i th√¨ d·ª´ng quy tr√¨nh           |
| 18   | G·ª≠i email th√¥ng b√°o ƒë·∫∑t v√© th√†nh c√¥ng                |
| 19   | C·∫≠p nh·∫≠t t√¨nh tr·∫°ng gh·∫ø sang ƒë√£ ƒë·∫∑t                  |
| 20   | L∆∞u th√¥ng tin v√© v√† kh√°ch h√†ng                       |


### B∆∞·ªõc 3: Ph√¢n lo·∫°i h√†nh ƒë·ªông theo kh·∫£ nƒÉng t√°i s·ª≠ d·ª•ng

Ph√¢n lo·∫°i c√°c h√†nh ƒë·ªông th√†nh 2 lo·∫°i: kh·∫£ tri (in ƒë·∫≠m) v√† b·∫•t kh·∫£ tri.

| B∆∞·ªõc | H√†nh ƒë·ªông                                            |
|------|------------------------------------------------------|
| 1    | **B·∫Øt ƒë·∫ßu quy tr√¨nh**                                |
| 2    | T·∫£i th√¥ng tin phim                                   |
| 3    | T·∫£i th√¥ng tin l·ªãch chi·∫øu ·ª©ng v·ªõi phim ƒë∆∞·ª£c ch·ªçn      |
| 4    | T·∫£i th√¥ng tin gh·∫ø t∆∞∆°ng ·ª©ng v·ªõi l·ªãch chi·∫øu ƒë∆∞·ª£c ch·ªçn |
| 5    | **X√°c minh gh·∫ø c√≤n tr·ªëng**                           |
| 6    | **N·∫øu t·ªìn t·∫°i gh·∫ø kh√¥ng tr·ªëng th√¨ d·ª´ng quy tr√¨nh**   |
| 7    | X√°c minh th√¥ng tin v√©                                |
| 8    | C·∫≠p nh·∫≠t t√¨nh tr·∫°ng gh·∫ø sang ƒë√£ gi·ªØ                  |
| 9    | T·∫°o m√£ QR thanh to√°n                                 |
| 10   | **Theo d√µi ti·∫øn tr√¨nh thanh to√°n**                   |
| 11   | **N·∫øu thanh to√°n th·∫•t b·∫°i th√¨ d·ª´ng quy tr√¨nh**       |
| 12   | C·∫≠p nh·∫≠t t√¨nh tr·∫°ng gh·∫ø sang ƒë√£ ƒë·∫∑t                  |
| 13   | L∆∞u th√¥ng tin v√© v√† kh√°ch h√†ng                       |
| 14   | G·ª≠i email th√¥ng b√°o ƒë·∫∑t v√© th√†nh c√¥ng                |

Sau khi ph√¢n lo·∫°i, chuy·ªÉn c√°c h√†nh ƒë·ªông b·∫•t kh·∫£ tri th√†nh c√°c ·ª©ng vi√™n 
d·ªãch v·ª• th·ª±c th·∫ø (Entity Service), g·ªìm:

* User Service v·ªõi c√°c nƒÉng l·ª±c: L·∫•y th√¥ng tin phim, l·ªãch chi·∫øu, gh·∫ø, c·∫≠p nh·∫≠t tr·∫°ng th√°i gh·∫ø v√† l·∫•y th√¥ng tin t√≥m t·∫Øt c·ªßa v√© (c√°c th√¥ng tin li√™n quan ƒë·∫øn 3 th√†nh ph·∫ßn tr√™n).
* Movie Service v·ªõi c√°c nƒÉng l·ª±c: T·∫°o v√©, h√≥a ƒë∆°n, t·∫°o m√£ QR code v√† th√¥ng b√°o tr·∫°ng th√°i thanh to√°n.
* Payment Service v·ªõi nƒÉng l·ª±c: L·∫•y th√¥ng tin ng∆∞·ªùi d√πng.

<p align="center">
  <img src="./assets/img.png" alt="C√°c ·ª©ng vi√™n d·ªãch v·ª• th·ª±c th·ªÉ" />
  <br/>
  <sub>C√°c ·ª©ng vi√™n d·ªãch v·ª• th·ª±c th·ªÉ </sub>
</p>

### B∆∞·ªõc 4: Nh·∫≠n di·ªán Process-Specific Logic

C√°c logic ƒëi·ªÅu ph·ªëi bao g·ªìm: 
* B·∫Øt ƒë·∫ßu quy tr√¨nh
* X√°c minh gh·∫ø c√≤n tr·ªëng
* Ki·ªÉm tra gh·∫ø tr·ªëng
* Theo d√µi thanh to√°n
* Ki·ªÉm tra tr·∫°ng th√°i thanh to√°n
* D·ª´ng quy tr√¨nh

C√°c logic n√†y s·∫Ω ƒë∆∞·ª£c gom chung v√†o ·ª©ng vi√™n d·ªãch v·ª• ƒëi·ªÅu ph·ªëi quy tr√¨nh 
ƒë·∫∑t v√© l√† Booking Service.

<p align="center">
  <img src="./assets/img2.png" width="" alt="·ª®ng vi√™n d·ªãch v·ª• ƒëi·ªÅu ph·ªëi" />
  <br/>
  <sub>·ª®ng vi√™n d·ªãch v·ª• ƒëi·ªÅu ph·ªëi</sub>
</p>

### B∆∞·ªõc 5: L·ª±a ch·ªçn c√°c t√†i nguy√™n

C√°c t√†i nguy√™n ƒë∆∞·ª£c s·ª≠ d·ª•ng trong to√†n b·ªô quy tr√¨nh x·ª≠ l√≠ bao g·ªìm:
* `/users/`
* `/movies/`
* `/payments/`
* `/seat-availability/`
* `/notification/`
* `/bookings/`
* `/auth/`

> L∆∞u √Ω: T√†i nguy√™n ·ª©ng v·ªõi route /auth/ s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng cho m·ª•c ƒë√≠ch x√°c th·ª±c ng∆∞·ªùi d√πng.

√Ånh x·∫° c√°c t√†i nguy√™n t∆∞∆°ng ·ª©ng v·ªõi c√°c d·ªãch v·ª• th·ª±c th·ªÉ.

| D·ªãch v·ª•          | T√†i nguy√™n   |
|------------------|--------------|
| User Service     | `/users/`    |
| Movie Service    | `/movies/`   |
| Payment Service  | `/payments/` |

### B∆∞·ªõc 6: Li√™n k·∫øt c√°c t√†i nguy√™n v·ªõi nƒÉng l·ª±c d·ªãch v·ª• v√† ph∆∞∆°ng th·ª©c

<p align="center">
  <img src="./assets/img3.png" width="" alt="C√°c ·ª©ng vi√™n d·ªãch v·ª• th·ª±c th·ªÉ c√πng nƒÉng l·ª±c x·ª≠ l√≠" />
  <br/>
  <sub>C√°c ·ª©ng vi√™n d·ªãch v·ª• th·ª±c th·ªÉ c√πng nƒÉng l·ª±c x·ª≠ l√≠</sub>
</p>

### B∆∞·ªõc 7: √Åp d·ª•ng c√°c quy t·∫Øc thi·∫øt k·∫ø h∆∞·ªõng d·ªãch v·ª•

C√°c nguy√™n t·∫Øc thi·∫øt k·∫ø h∆∞·ªõng d·ªãch v·ª• ƒë∆∞·ª£c √°p d·ª•ng ·ªü ƒë√¢y bao g·ªìm: 

* Tr√°nh ph·ª• thu·ªôc gi·ªØa c√°c Entity Service.
* Ch·ªâ tri·ªÉn khai logic ƒëi·ªÅu ph·ªëi ·ªü Task Service.

### B∆∞·ªõc 8: X√°c ƒë·ªãnh ·ª©ng vi√™n t·ªï h·ª£p d·ªãch v·ª•

Trong qu√° tr√¨nh tri·ªÉn khai logic nghi·ªáp v·ª• c·ªßa module, Booking Service s·∫Ω c·∫ßn t∆∞∆°ng t√°c v·ªõi c√°c d·ªãch v·ª• th·ª±c th·ªÉ l√† User Service, Movie Service, Payment Service ƒë·ªÉ trao ƒë·ªïi c√°c th√¥ng tin sau.

| Service ƒë√≠ch     | N·ªôi dung                        | ƒê·ªãnh d·∫°ng |
|------------------|---------------------------------|-----------|
| User Service     | Th√¥ng tin ng∆∞·ªùi d√πng            | JSON      |
| Movie Service    | Th√¥ng tin phim, l·ªãch chi·∫øu, gh·∫ø | JSON      |
| Payment Service  | Th√¥ng tin thanh to√°n            | JSON      |

<p align="center">
  <img src="./assets/img4.png" width="" alt="T·ªï h·ª£p c√°c ·ª©ng vi√™n d·ªãch v·ª• c·ªßa module" />
  <br/>
  <sub>T·ªï h·ª£p c√°c ·ª©ng vi√™n d·ªãch v·ª• c·ªßa module</sub>
</p>

### B∆∞·ªõc 9: Ph√¢n t√≠ch y√™u c·∫ßu x·ª≠ l√Ω

Trong c√°c logic ƒëi·ªÅu ph·ªëi ƒë∆∞·ª£c ƒë·ªÅ c·∫≠p b√™n tr√™n, logic `ki·ªÉm tra tr·∫°ng th√°i gh·∫ø c√≤n tr·ªëng` l√† logic c√≥ th·ªÉ thay ƒë·ªïi theo quy t·∫Øc kinh doanh (VD: gi·ªØ ch·ªó t·∫°m, ch·∫∑n gh·∫ø kƒ© thu·∫≠t v√† ph√¢n quy·ªÅn gh·∫ø ) n√™n s·∫Ω ƒë∆∞·ª£c ph√¢n t√°ch ra th√†nh m·ªôt Micro Service, hay m·ªôt phi√™n b·∫£n nh·ªè c·ªßa Task Service.

Ngo√†i ra, `g·ª≠i th√¥ng b√°o cho ng∆∞·ªùi d√πng` c≈©ng l√† m·ªôt logic c√≥ th·ªÉ t·∫£i s·ª≠  d·ª•ng ƒë∆∞·ª£c ·ªü nhi·ªÅu module kh√°c (VD: x√°c th·ª±c th√¥ng tin ng∆∞·ªùi d√πng, nh·∫Øc l·ªãch xem phim, th√¥ng b√°o thay ƒë·ªïi su·∫•t chi·∫øu) nh∆∞ng l·∫°i kh√¥ng li√™n quan tr·ª±c ti·∫øp ƒë·∫øn quy tr√¨nh kinh doanh n√™n s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh m·ªôt d·ªãch v·ª• ti·ªán √≠ch.

Nh∆∞ v·∫≠y, c√°c ngu·ªìn t√†i nguy√™n cho c√°c d·ªãch v·ª• ƒëi·ªÅu ph·ªëi v√† ti·ªán √≠ch s·∫Ω ƒë∆∞·ª£c ph√¢n ph·ªëi nh∆∞ sau.

| D·ªãch v·ª•                   | T√†i nguy√™n             |
|---------------------------|------------------------|
| Booking Service           | `/booking/`            |
| Seat Availability Service | `/seat-availability/`  |
| Notification Service      | `/notification/`       |

C√°c nƒÉng l·ª±c t∆∞∆°ng ·ª©ng c·ªßa 2 d·ªãch v·ª• n√†y s·∫Ω l√†:
 * Seat Availability Service: Ki·ªÉm tra tr·∫°ng th√°i tr·ªëng c·ªßa gh·∫ø
 * Notification Service: G·ª≠i email th√¥ng b√°o thanh to√°n th√†nh c√¥ng ƒë·∫øn ng∆∞·ªùi d√πng

<p align="center">
  <img src="./assets/img8.png" width="" alt="C√°c ·ª©ng vi√™n d·ªãch v·ª• micro v√† ti·ªán √≠ch" />
  <br/>
  <sub>C√°c ·ª©ng vi√™n d·ªãch v·ª• micro v√† ti·ªán √≠ch</sub>
</p>

### B∆∞·ªõc 10: X√°c ƒë·ªãnh ph∆∞∆°ng th·ª©c ·ª©ng v·ªõi c√°c nƒÉng l·ª±c c·ªßa d·ªãch v·ª• d·∫°ng micro

<p align="center">
  <img src="./assets/img6.png" width="" alt="·ª®ng vi√™n d·ªãch v·ª• micro v√† nƒÉng l·ª±c x·ª≠ l√≠" />
  <br/>
  <sub>·ª®ng vi√™n d·ªãch v·ª• micro v√† nƒÉng l·ª±c x·ª≠ l√≠</sub>
</p>

### B∆∞·ªõc 11: X√°c ƒë·ªãnh ph∆∞∆°ng th·ª©c ·ª©ng v·ªõi c√°c nƒÉng l·ª±c c·ªßa d·ªãch v·ª• ti·ªán √≠ch

<p align="center">
  <img src="./assets/img5.png" width="" alt="·ª®ng vi√™n d·ªãch v·ª• ti·ªán √≠ch v√† nƒÉng l·ª±c x·ª≠ l√≠" />
  <br/>
  <sub>·ª®ng vi√™n d·ªãch v·ª• ti·ªán √≠ch v√† nƒÉng l·ª±c x·ª≠ l√≠</sub>
</p>

### B∆∞·ªõc 12: √Åp d·ª•ng l·∫°i nguy√™n t·∫Øc thi·∫øt k·∫ø h∆∞·ªõng d·ªãch v·ª•

√Åp d·ª•ng 2 nguy√™n t·∫Øc thi·∫øt k·∫ø h∆∞·ªõng d·ªãch v·ª• ƒë√£ tr√¨nh b√†y b√™n tr√™n v√† n·ªôi dung ph√¢n t√≠ch x·ª≠ l√≠ ·ªü b∆∞·ªõc 9, t·ªï h·ª£p d·ªãch v·ª• ƒë∆∞·ª£c s·ª≠ d·ª•ng cho module ƒë·∫∑t v√© s·∫Ω ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ h√¨nh d∆∞·ªõi ƒë√¢y.

<p align="center">
  <img src="./assets/img7.png" width="" alt="·ªï h·ª£p c√°c ·ª©ng vi√™n d·ªãch v·ª• c·ªßa module sau khi ph√¢n t√°ch l·∫°i" />
  <br/>
  <sub>T·ªï h·ª£p c√°c ·ª©ng vi√™n d·ªãch v·ª• c·ªßa module sau khi ph√¢n t√°ch l·∫°i</sub>
</p>

### K·∫æT QU·∫¢ PH√ÇN LO·∫†I D·ªäCH V·ª§


| D·ªãch v·ª•                   | Tr√°ch nhi·ªám                                                                                                                                                    | C√¥ng ngh·ªá  |
|---------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
| Gateway                   | ƒêi·ªÅu h∆∞·ªõng y√™u c·∫ßu ƒë·∫øn c√°c service kh√°c                                                                                                                        | Springboot |
| Auth Service              | X√°c minh th√¥ng tin ƒëƒÉng nh·∫≠p c·ªßa ng∆∞·ªùi d√πng                                                                                                                    | Springboot |
| User Service              | Qu·∫£n l√≠ th√¥ng tin ng∆∞·ªùi d√πng                                                                                                                                   | Springboot |
| Movie Service             | Qu·∫£n l√≠ th√¥ng tin phim, ph√≤ng, l·ªãch chi·∫øu, gh·∫ø                                                                                                                 | Springboot |
| Payment Service           | Qu·∫£n l√≠ th√¥ng tin v√©, h√≥a ƒë∆°n; t·∫°o m√£ QR v√† th√¥ng b√°o tr·∫°ng th√°i thanh to√°n                                                                                    | Springboot |
| Seat Availability Service | Ki·ªÉm tra tr·∫°ng th√°i s·∫µn s√†ng c·ªßa gh·∫ø                                                                                                                           | Springboot |
| Notification Service      | G·ª≠i th√¥ng b√°o ƒë·∫∑t v√© th√†nh c√¥ng ƒë·∫øn ng∆∞·ªùi d√πng                                                                                                                 | Springboot |
| Booking Service           | X·ª≠ l√≠ to√†n b·ªô quy tr√¨nh t·ª´ l·∫•y c√°c th√¥ng tin phim, l·ªãch chi·∫øu, gh·∫ø; x√°c minh tr·∫°ng th√°i gh·∫ø, x√°c minh th√¥ng tin v√©; thanh to√°n v√† g·ª≠i th√¥ng b√°o ƒë·∫øn ng∆∞·ªùi d√πng | Springboot |
| Registry Service          | C·∫ßu n·ªëi gi·ªØa c√°c d·ªãch v·ª• v·ªõi nhau                                                                                                                              | Springboot |

> L∆∞u √Ω: Gateway, Auth Service, Registry Service l√† c√°c th√†nh ph·∫ßn c·ªë ƒë·ªãnh c·ªßa h·ªá th·ªëng (kh√¥ng ph·ª• thu·ªôc v√†o y√™u c·∫ßu c·ª• th·ªÉ c·ªßa module).

---

## 3. üîÑ Giao ti·∫øp gi·ªØa c√°c d·ªãch v·ª•

### Ph∆∞∆°ng th·ª©c giao ti·∫øp

C√°c service trong h·ªá th·ªëng giao ti·∫øp v√† ph·ªëi h·ª£p v·ªõi nhau th√¥ng qua **REST APIs** v√† **Kafka Message Broker** 
gi√∫p tƒÉng t√≠nh linh ho·∫°t, kh·∫£ nƒÉng m·ªü r·ªông v√† ƒë·∫£m b·∫£o hi·ªáu su·∫•t c·ªßa to√†n b·ªô h·ªá th·ªëng khi ph·∫£i x·ª≠ l√Ω l∆∞·ª£ng l·ªõn 
d·ªØ li·ªáu ho·∫∑c ng∆∞·ªùi d√πng ƒë·ªìng th·ªùi.

### C√°c lu·ªìng giao ti·∫øp ch√≠nh

* Gateway ‚áÑ Booking Service (REST)
  * Gateway l√†m nhi·ªám v·ª• ƒë·ªãnh tuy·∫øn c√°c y√™u c·∫ßu ƒë·∫øn Booking Service.
* Booking Service ‚áÑ Movie Service (REST, Kafka)
  * Booking Service g·ªçi Movie Service ƒë·ªÉ th·ª±c hi·ªán c√°c x·ª≠ l√≠ li√™n quan ƒë·∫øn l·∫•y c√°c th√¥ng tin phim, l·ªãch chi·∫øu, gh·∫ø ƒë·ªìng b·ªô v√† c·∫≠p nh·∫≠t tr·∫°ng th√°i gh·∫ø theo ki·ªÉu b·∫•t ƒë·ªìng b·ªô.
* Booking Service ‚áÑ Payment Service (REST, Kafka)
  * Booking Service g·ªçi Payment Service ƒë·ªÉ th·ª±c hi·ªán t·∫°o m√£ QR thanh to√°n.
  * Payment Service g·ªçi Booking Service theo ki·ªÉu b·∫•t ƒë·ªìng b·ªô ƒë·ªÉ tr·∫£ v·ªÅ tr·∫°ng th√°i c·ªßa c√°c thanh to√°n.
* Booking Service ‚áÑ Seat Available Service (REST)
  * Booking Service g·ªçi Seat Available Service ƒë·ªÉ ki·ªÉm tra tr·∫°ng th√°i gh·∫ø c√≤n tr·ªëng.
* Booking Service ‚áÑ Notification Service (Kafka)
  * Booking Service g·ªçi Notification Service theo ki·ªÉu b·∫•t ƒë·ªìng b·ªô ƒë·ªÉ g·ª≠i email th√¥ng b√°o ƒë·∫∑t v√© th√†nh c√¥ng ƒë·∫øn ng∆∞·ªùi d√πng.
* Seat Available Service ‚áÑ Movie Service (REST)
  * Seat Available Service g·ªçi Movie Service ƒë·ªÉ l·∫•y tr·∫°ng th√°i c·ªßa c√°c gh·∫ø.

---

## 4. üóÇÔ∏è Thi·∫øt k·∫ø c∆° s·ªü d·ªØ li·ªáu

## 4.1. User Service Database

### B·∫£ng: users
| Column   | Data Type    | Description                    |
|----------|--------------|--------------------------------|
| id       | VARCHAR(255) | ID ng∆∞·ªùi d√πng (Primary Key)   |
| username | VARCHAR(255) | T√™n ƒëƒÉng nh·∫≠p (Unique)         |
| password | VARCHAR(255) | M·∫≠t kh·∫©u                       |
| email    | VARCHAR(255) | Email ng∆∞·ªùi d√πng               |
| phone    | VARCHAR(255) | S·ªë ƒëi·ªán tho·∫°i                  |

---

## 4.2. Movie Service Database

### B·∫£ng: movies
| Column      | Data Type    | Description                |
|-------------|--------------|----------------------------|
| id          | VARCHAR(255) | ID phim (Primary Key)      |
| name        | VARCHAR(255) | T√™n phim                   |
| cover       | VARCHAR(255) | ·∫¢nh b√¨a phim               |
| genre       | VARCHAR(255) | Th·ªÉ lo·∫°i phim              |
| duration    | INTEGER(10)  | Th·ªùi l∆∞·ª£ng phim (ph√∫t)     |
| language    | VARCHAR(255) | Ng√¥n ng·ªØ phim              |
| director    | VARCHAR(255) | ƒê·∫°o di·ªÖn                   |
| cast        | VARCHAR(255) | Di·ªÖn vi√™n                  |
| description | VARCHAR(255) | M√¥ t·∫£ phim                 |

### B·∫£ng: rooms
| Column | Data Type    | Description              |
|--------|--------------|--------------------------|
| id     | VARCHAR(255) | ID ph√≤ng (Primary Key)   |
| name   | VARCHAR(255) | T√™n ph√≤ng                |
| type   | VARCHAR(255) | Lo·∫°i ph√≤ng               |

### B·∫£ng: schedules
| Column    | Data Type    | Description                             |
|-----------|--------------|----------------------------------------|
| id        | VARCHAR(255) | ID l·ªãch chi·∫øu (Primary Key)             |
| start     | TIMESTAMP    | Th·ªùi gian b·∫Øt ƒë·∫ßu chi·∫øu                 |
| end       | TIMESTAMP    | Th·ªùi gian k·∫øt th√∫c chi·∫øu                |
| moviesid  | VARCHAR(255) | ID phim (Foreign Key t·ªõi b·∫£ng movies)   |
| roomsid   | VARCHAR(255) | ID ph√≤ng (Foreign Key t·ªõi b·∫£ng rooms)   |

### B·∫£ng: seats
| Column  | Data Type    | Description                           |
|---------|--------------|---------------------------------------|
| id      | VARCHAR(255) | ID gh·∫ø (Primary Key)                  |
| name    | VARCHAR(255) | T√™n/S·ªë gh·∫ø                            |
| roomsid | VARCHAR(255) | ID ph√≤ng (Foreign Key t·ªõi b·∫£ng rooms) |

### B·∫£ng: seats_schedules
| Column                | Data Type    | Description                                |
|-----------------------|--------------|--------------------------------------------|
| id                    | VARCHAR(255) | ID (Primary Key)                           |
| status                | VARCHAR(255) | Tr·∫°ng th√°i gh·∫ø (tr·ªëng/ƒë√£ ƒë·∫∑t/ƒëang gi·ªØ)     |
| seat_hold_start_time  | TIMESTAMP    | Th·ªùi gian b·∫Øt ƒë·∫ßu gi·ªØ gh·∫ø                 |
| seat_hold_end_time    | TIMESTAMP    | Th·ªùi gian k·∫øt th√∫c gi·ªØ gh·∫ø                |
| schedulesid           | VARCHAR(255) | ID l·ªãch chi·∫øu (Foreign Key t·ªõi schedules)  |
| seatsid               | VARCHAR(255) | ID gh·∫ø (Foreign Key t·ªõi b·∫£ng seats)       |

---

## 4.3. Payment Service Database

### B·∫£ng: tickets
| Column           | Data Type    | Description                                       |
|------------------|--------------|---------------------------------------------------|
| id               | VARCHAR(255) | ID v√© (Primary Key)                               |
| price            | FLOAT(10)    | Gi√° v√©                                            |
| seat_schedule_id | VARCHAR(255) | ID gh·∫ø-l·ªãch chi·∫øu       |

### B·∫£ng: invoices
| Column         | Data Type    | Description                           |
|----------------|--------------|---------------------------------------|
| id             | VARCHAR(255) | ID h√≥a ƒë∆°n (Primary Key)              |
| customer_email | VARCHAR(255) | Email kh√°ch h√†ng                      |
| customer_name  | VARCHAR(255) | T√™n kh√°ch h√†ng                        |
| customer_phone | VARCHAR(255) | S·ªë ƒëi·ªán tho·∫°i kh√°ch h√†ng              |
| discount       | FLOAT(10)    | S·ªë ti·ªÅn gi·∫£m gi√°                      |
| first_price    | FLOAT(10)    | Gi√° g·ªëc                               |
| last_price     | FLOAT(10)    | Gi√° cu·ªëi c√πng (sau gi·∫£m gi√°)          |
| status         | VARCHAR(255) | Tr·∫°ng th√°i h√≥a ƒë∆°n                    |
| time_created   | INTEGER(10)  | Th·ªùi gian t·∫°o h√≥a ƒë∆°n (timestamp)     |
| user_id        | VARCHAR(255) | ID ng∆∞·ªùi d√πng     |

### B·∫£ng: tickets_invoices
| Column    | Data Type    | Description                             |
|-----------|--------------|----------------------------------------|
| id        | VARCHAR(255) | ID (Primary Key)                        |
| ticketsid | VARCHAR(255) | ID v√© (Foreign Key t·ªõi b·∫£ng tickets)    |
| EntityId  | VARCHAR(255) | ID h√≥a ƒë∆°n (Foreign Key t·ªõi invoices)   |

<p align="center">
  <img src="./assets/database.jpg" alt="C∆° s·ªü d·ªØ li·ªáu" />
  <br/>
  <sub>C∆° s·ªü d·ªØ li·ªáu</sub>
</p>

---

## 5. üîê B·∫£o m·∫≠t trong h·ªá th·ªëng

H·ªá th·ªëng ch·ªâ c√≥ th·ªÉ truy c·∫≠p th√¥ng qua Gateway v√† s·ª≠ d·ª•ng c∆° ch·∫ø c·ªßa JWT ƒë·ªÉ qu·∫£n l√≠ c√°c phi√™n ng∆∞·ªùi d√πng.
* JWT token ƒë∆∞·ª£c m√£ h√≥a b·ªüi thu·∫≠t to√°n m√£ kh√≥a kh√≥a ƒë·ªëi x·ª©ng
  * Token ƒë∆∞·ª£c ph√°t h√†nh ·ªü Auth Service s·ª≠ d·ª•ng kh√≥a b√≠ m·∫≠t.
  * Token ƒë∆∞·ª£c x√°c minh t·∫°i Gateway v√† c√°c Service c√≤n l·∫°i (tr·ª´ Registry Service) b·∫±ng kh√≥a c√¥ng khai.
* Qu√° tr√¨nh x√°c th·ª±c token s·∫Ω ƒë∆∞·ª£c th·ª±c thi trong c√°c tr∆∞·ªùng h·ª£p
  * C√≥ y√™u c·∫ßu b√™n ngo√†i g·ªçi ƒë·∫øn Gateway.
  * C√≥ l·ªùi g·ªçi n·ªôi b·ªô gi·ªØa c√°c Service.

---

## 6. üì¶ K·∫ø ho·∫°ch tri·ªÉn khai

* S·ª≠ d·ª•ng `docker-compose` ƒë·ªÉ qu·∫£n l√≠ m√¥i tr∆∞·ªùng local.
* M·ªói Service ƒë·ªÅu c√≥ Dockerfile ri√™ng v·ªõi c·∫•u h√¨nh m√¥i tr∆∞·ªùng ƒë∆∞·ª£c l∆∞u trong file `application.yaml`.

---

## 7. üé® S∆° ƒë·ªì ki·∫øn tr√∫c

<p align="center">
  <img src="./assets/architecture.png" alt="S∆° ƒë·ªì ki·∫øn tr√∫c" />
  <br/>
  <sub>S∆° ƒë·ªì ki·∫øn tr√∫c</sub>
</p>

---

## ‚úÖ Summary

V·ªõi b√†i to√°n ƒë·∫∑t v√© xem phim, vi·ªác tri·ªÉn khai m·ªôt h·ªá th·ªëng d·∫°ng microservice nh∆∞ tr√™n s·∫Ω gi√∫p ƒë√°p ·ª©ng 
c√°c y√™u c·∫ßu v·ªÅ hi·ªáu nƒÉng, kh·∫£ nƒÉng m·ªü r·ªông v√† d·ªÖ d√†ng b·∫£o tr√¨, c·ª• th·ªÉ:
* **T√°ch bi·ªát ch·ª©c nƒÉng r√µ, d·ªÖ d√†ng m·ªü r·ªông**: Quy tr√¨nh ƒë·∫∑t v√© g·ªìm nhi·ªÅu b∆∞·ªõc ƒë·ªôc l·∫≠p n√™n vi·ªác m·ªói d·ªãch v·ª• 
ch·ªãu tr√°ch nhi·ªám m·ªôt ph·∫ßn ch·ª©c nƒÉng c·ª• th·ªÉ s·∫Ω gi√∫p gi·∫£m thi·ªÉu s·ª± ph·ª• thu·ªôc l·∫´n nhau c≈©ng nh∆∞ ƒë·∫£m b·∫£o vi·ªác 
m·ªü r·ªông kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c ph·∫ßn kh√°c c·ªßa h·ªá th·ªëng.
* **REST API cho giao ti·∫øp ƒë·ªìng b·ªô**: Nh·ªØng t√°c v·ª• c·∫ßn ph·∫£n h·ªìi ngay l·∫≠p t·ª©c ƒë·ªÉ ƒë·∫£m b·∫£o tr·∫£i nghi·ªám ng∆∞·ªùi d√πng, 
nh∆∞ x√°c minh gh·∫ø c√≤n tr·ªëng ho·∫∑c t·∫°o m√£ thanh to√°n, ƒë∆∞·ª£c th·ª±c hi·ªán qua REST API nh·∫±m ƒë·∫£m b·∫£o ƒë·ªô ch√≠nh x√°c v√† 
t√≠nh t·ª©c th·ªùi.
* **T·ªëi ∆∞u hi·ªáu su·∫•t v·ªõi Kafka**: C√°c t√°c v·ª• kh√¥ng y√™u c·∫ßu ph·∫£n h·ªìi t·ª©c th·ªùi nh∆∞ g·ª≠i email x√°c nh·∫≠n, c·∫≠p nh·∫≠t 
tr·∫°ng th√°i thanh to√°n, ho·∫∑c tr·∫°ng th√°i gh·∫ø ƒë∆∞·ª£c x·ª≠ l√Ω b·∫•t ƒë·ªìng b·ªô qua Kafka, gi√∫p h·ªá th·ªëng v·∫≠n h√†nh ·ªïn ƒë·ªãnh 
ngay c·∫£ khi c√≥ l∆∞u l∆∞·ª£ng truy c·∫≠p l·ªõn.
* **TƒÉng c∆∞·ªùng b·∫£o m·∫≠t v√† ki·ªÉm so√°t truy c·∫≠p**: Vi·ªác s·ª≠ d·ª•ng Gateway k·∫øt h·ª£p c∆° ch·∫ø JWT gi√∫p ki·ªÉm so√°t truy c·∫≠p 
v√† ƒë·∫£m b·∫£o r·∫±ng m·ªçi y√™u c·∫ßu ƒë·ªÅu ƒë∆∞·ª£c x√°c th·ª±c tr∆∞·ªõc khi v√†o h·ªá th·ªëng n·ªôi b·ªô.

---
